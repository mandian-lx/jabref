--- jabref-2.11.1/build.xml.antlr
+++ jabref-2.11.1/build.xml
@@ -62,6 +62,9 @@
 	<property name="txt.dir" value="." />
 	<property name="java.dir" value="src/main/java" />
     <property name="gen.dir" value="src/main/gen" />
+    <property name="grammar.gen.dir" value="${gen.dir}/net/sf/jabref/logic/bst/" />
+    <property name="antlr4.src.dir" value="${java.dir}/../antlr4/" />
+    <property name="search.gen.dir" value="${gen.dir}/net/sf/jabref/search/" />
 	<property name="osx.dir" value="${resources.dir}/osx" />
 	<property name="win.installer.dir" value="${resources.dir}/windows/nsis" />
 	<property name="resource.dir" value="${resources.dir}/resource" />
@@ -101,6 +104,7 @@
 		<pathelement path="${build.classes}" />
 		<pathelement path="${build.dir}" />
		<pathelement path="${build.lib}" />
+		<pathelement path="${gen.dir}" />
 		<filelist refid="jars" />
 	</path>
 
@@ -120,8 +128,126 @@
 		</java>
 	</target>
 
+	<path id="classpath.antlr3">
+        	<fileset dir="${lib.dir}">
+        	        <include name="*.jar"/>
+	        </fileset>
+
+        	<fileset dir="/usr/share/java">
+			<include name="antlr3.jar"/>
+			<include name="antlr3-runtime.jar"/>
+			<include name="stringtemplate4/ST4.jar"/>
+		</fileset>
+	        <!-- the ANTLR jar is in the lib directory, of course -->
+	</path>
+
+	<path id="classpath.antlr4">
+		<fileset dir="${lib.dir}">
+			<include name="*.jar"/>
+		</fileset>
+
+		<fileset dir="/usr/share/java">
+			<include name="antlr3-runtime.jar"/>
+			<include name="antlr4/antlr4.jar"/>
+			<include name="antlr4/antlr4-runtime.jar"/>
+			<include name="stringtemplate4/ST4.jar"/>
+		</fileset>
+		<!-- the ANTLR jar is in the lib directory, of course -->
+	</path>
+
+	<path id="classpath.jaxb">
+		<fileset dir="${lib.dir}">
+			<include name="*.jar"/>
+		</fileset>
+
+		<fileset dir="/usr/lib/jvm/java/lib">
+			<include name="tools.jar"/>
+		</fileset>
+
+		<fileset dir="/usr/share/java/">
+			<include name="istack-commons-runtime.jar"/>
+			<include name="istack-commons-tools.jar"/>
+		</fileset>
+
+		<fileset dir="/usr/share/java/glassfish-jaxb">
+			<!--include name="jaxb-impl.jar"/-->
+			<include name="jaxb-xjc.jar"/>
+		</fileset>
+	</path>
+	
+	<target name="generate-antlr3" description="Generates BstLexer.java and BstParser.java from the Bst.g grammar file using antlr3.">
+		<echo>Generates BstLexer.java and BstParser.java from the Bst.g grammar file using antlr3.</echo>
+		<!--mkdir dir="${grammar.gen.dir}" /-->
+		<java classname="org.antlr.Tool" fork="true" failonerror="true">
+			<arg value="-verbose"/>
+			<!--arg value="-make"/-->
+			<arg value="-fo"/>
+			<arg path="${grammar.gen.dir}"/>
+			<arg value="src/main/antlr3/net/sf/jabref/bst/Bst.g"/>
+			<!--arg value="file('src/main/gen/net/sf/jabref/bst/')" /-->
+			<!--arg value="antlrSource" /-->
+			<classpath refid="classpath.antlr3" />
+		</java>
+	</target>
+
+	<target name="generate-antlr4" description="Generates java files for Search.g antlr4.">
+		<echo>Generates java files for Search.g antlr4.</echo>
+		<!--mkdir dir="${search.gen.dir}" /-->
+		<mkdir dir="${search.gen.dir}" />
+		<java classname="org.antlr.v4.Tool" fork="true" failonerror="true" dir="${antlr4.src.dir}">
+			<arg value="-o"/>
+			<arg value="../gen"/>
+			<arg value="-visitor"/>
+			<arg value="-no-listener"/>
+			<arg value="-package"/>
+			<arg value="net.sf.jabref.search"/>
+			<arg value="net/sf/jabref/search/Search.g4"/>
+			<!--arg value="file('src/main/gen/net/sf/jabref/bst/')" /-->
+			<!--arg value="antlrSource" /-->
+			<classpath refid="classpath.antlr4" />
+		</java>
+	</target>
+
+	<taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask" >
+		<classpath refid="classpath.jaxb" />
+	</taskdef>
+    
+    	<target name="generate-jaxb" depends="generate-jaxb-medline, generate-jaxb-bibtexml" />
+
+	<target name="generate-jaxb-medline">
+		<echo>Generates java files for medline.xsd xjc.</echo>
+		<!--mkdir dir="src/main/gen/net/sf/jabref/logic/importer/fileformat/medline"/-->
+		<!--xjc destdir="${gen.dir}" package="net.sf.jabref.logic.importer.fileformat.medline" >
+			<schema dir="src/main/resources/xjc/medline" includes="medline.xsd"/>
+		</xjc-->
+		<java classname="com.sun.tools.internal.xjc.XJCFacade" fork="true" failonerror="true" dir=".">
+			<arg value="-d" />
+			<arg value="${gen.dir}" />
+			<arg value="-p" />
+			<arg value="net.sf.jabref.logic.importer.fileformat.medline"/>
+			<arg path="src/main/resources/xjc/medline/medline.xsd" />
+			<classpath refid="classpath.jaxb" />
+		</java>
+	</target>
+
+	<target name="generate-jaxb-bibtexml">
+		<echo>Generates java files for bibtexml.xsd xjc.</echo>
+		<!--mkdir dir="src/main/gen/net/sf/jabref/logic/importer/fileformat/bibtexml"/-->
+		<!--xjc destdir="${gen.dir}" package="net.sf.jabref.logic.importer.fileformat.bibtexml" >
+			<schema dir="src/main/resources/xjc/bibtexml" includes="bibtexml.xsd"/>
+		</xjc-->
+		<java classname="com.sun.tools.internal.xjc.XJCFacade" fork="true" failonerror="true" dir=".">
+			<arg value="-d" />
+			<arg path="${gen.dir}" />
+			<arg value="-p" />
+			<arg value="net.sf.jabref.logic.importer.fileformat.bibtexml"/>
+			<arg path="src/main/resources/xjc/bibtexml/bibtexml.xsd" />
+			<classpath refid="classpath.jaxb" />
+		</java>
+	</target>
+    
 	<!-- Compiles project -->
-	<target name="compile">
+	<target name="compile" depends="generate-antlr3, generate-antlr4">
 		<mkdir dir="${build.classes}" />
 		<javac destdir="${build.classes}" encoding="UTF8" source="1.7" target="1.7">
 			<src path="${java.dir}" />
